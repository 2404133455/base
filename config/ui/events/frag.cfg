event_frag_classic = [
    uiimage $deadtex 0xFFFFFF 0 0 $ui_hud_texttiny [ uistyle leftmiddle; uiimageaspect 1; uiimageshadow 0.001 0x20202020 1 ]
    uitext (geteventlist $event_id "args" "console") $ui_texttiny [
        uistyle leftmiddle
        uitextalign -1
        uicolourset $event_concolour
    ]
]

event_frag_normal = [
    uiimage $deadtex 0xFFFFFF 0 0 $ui_hud_texttiny [ uistyle leftmiddle; uiimageaspect 1; uiimageshadow 0.001 0x20202020 1 ]
    local event_this event_self event_extra event_textsize event_weap event_weapflags event_context event_style event_actflags event_team event_prize

    event_this = (geteventtag $event_id "client" 0 "clientnum")
    event_self = (= $event_this (geteventtag $event_id "client" 1 "clientnum"))
    event_extra = 0
    event_textsize = $ui_texttiny
    event_weap = (geteventlist $event_id "args" "fromweap")
    if (>= $event_weap 0) [
        event_weapflags = (geteventlist $event_id "args" "fromflags")
    ] [
        event_weap = (geteventlist $event_id "args" "actweap")
        event_weapflags = (geteventlist $event_id "args" "actflags")
    ]
    event_context = (geteventlist $event_id "args" "context")
    event_style = (geteventlist $event_id "args" "style")
    event_actflags = (geteventlist $event_id "args" "actflags")
    event_prize = (geteventlist $event_id "args" "prize")

    loopeventgroups $event_id "client" 0 0 event_client [
        if $event_client [
            if $event_extra [
                uitext "+" $event_textsize [
                    uistyle leftmiddle
                    uitextalign -1
                    uicolourset $colourgrey
                ]
            ]

            uitext (geteventname $event_id "client" $event_client) $event_textsize [
                uistyle leftmiddle
                uitextalign -1
                if $event_extra [ uicolourscale 0xA0A0A0 ]
            ]

            if (! $event_extra) [
                event_team = (geteventtag $event_id "client" 0 "team")
                if (< $event_team $T_ENEMY) [
                    if $event_self [
                        uiimage $warningtex (pulsecolour $PULSE_WARN) 0 0 $ui_hud_texttiny [ uistyle leftmiddle; uiimageaspect 1; uiimageshadow 0.001 0x20202020 1 ]
                    ] [
                        if (&& (! (& $mutators (<< 1 $G_M_FFA))) (= $event_team (geteventtag $event_id "client" 1 "team"))) [
                            uiimage $warningtex (pulsecolour $PULSE_WARN) 0 0 $ui_hud_texttiny [ uistyle leftmiddle; uiimageaspect 1; uiimageshadow 0.001 0x20202020 1 ]
                        ]
                    ]
                ]
                event_extra = 1
                event_textsize = (*f $ui_texttiny 0.75)
            ]
        ]
    ]

    if (>= $event_weap 0) [
        local event_weapon
        event_weapon = (at $W_NAMES $event_weap)
        uiimage $[@[event_weapon]eventtex] $[@[event_weapon]colour] 0 0 $ui_hud_texttiny [
            uistyle leftmiddle
            uiimageaspect 1
            if (& $event_weapflags $HIT_ALT) [
                uiimageshadow 0.001 (modcolour $colourcyan 0.25) 1
            ] [
                uiimageshadow 0.001 (modcolour $colourmagenta 0.25) 1
            ]
        ]
    ]

    if (geteventlist $event_id "args" "burnfunc") [
        uiimage $burntex (pulsecolour $PULSE_BURN) 0 0 $ui_hud_texttiny [ uistyle leftmiddle; uiimageaspect 1; uiimageshadow 0.001 0x20202020 1 ]
    ]
    if (geteventlist $event_id "args" "bleedfunc") [
        uiimage $bleedtex (pulsecolour $PULSE_BLEED) 0 0 $ui_hud_texttiny [ uistyle leftmiddle; uiimageaspect 1; uiimageshadow 0.001 0x20202020 1 ]
    ]
    if (geteventlist $event_id "args" "shockfunc") [
        uiimage $shocktex (pulsecolour $PULSE_SHOCK) 0 0 $ui_hud_texttiny [ uistyle leftmiddle; uiimageaspect 1; uiimageshadow 0.001 0x20202020 1 ]
    ]
    if (geteventlist $event_id "args" "corrodefunc") [
        uiimage $corrodetex (pulsecolour $PULSE_CORRODE) 0 0 $ui_hud_texttiny [ uistyle leftmiddle; uiimageaspect 1; uiimageshadow 0.001 0x20202020 1 ]
    ]

    if (!=s $event_context "") [
        uitext $event_context (*f $ui_texttiny 0.75) [
            uistyle leftmiddle
            uitextalign -1
        ]
    ]

    if (! $event_self) [
        uitext (geteventname $event_id "client" 0) $ui_texttiny [
            uistyle leftmiddle
            uitextalign -1
        ]
    ]

    if $event_style [
        if (& $event_style $FRAG_HEADSHOT) [
            uitext "HEADSHOT" (*f $ui_texttiny 0.65) [
                uistyle leftmiddle
                uitextalign -1
                uicolourset (pulsecolour $PULSE_HEADSHOT)
            ]
        ]

        if (& $event_style $FRAG_REVENGE) [
            uitext "REVENGE" (*f $ui_texttiny 0.65) [
                uistyle leftmiddle
                uitextalign -1
                uicolourset (pulsecolour $PULSE_REVENGE)
            ]
        ]

        if (& $event_style $FRAG_DOMINATE) [
            uiimage $dominatedtex (pulsecolour $PULSE_DOMINATE) 0 0 $ui_hud_texttiny [
                uistyle leftmiddle
                uiimageaspect 1
            ]
        ]

        if (& $event_style $FRAG_BREAKER) [
            uitext "SPREE BREAKER" (*f $ui_texttiny 0.65) [
                uistyle leftmiddle
                uitextalign -1
                uicolourset (pulsecolour $PULSE_BREAK)
            ]
        ]

        if (& $event_style $FRAG_MKILL1) [
            uitext "x2" (*f $ui_texttiny 0.75) [
                uistyle leftmiddle
                uitextalign -1
                uicolourset (pulsecolour $PULSE_MULTI)
            ]
        ]

        if (& $event_style $FRAG_MKILL2) [
            uitext "x3" (*f $ui_texttiny 0.75) [
                uistyle leftmiddle
                uitextalign -1
                uicolourset (pulsecolour $PULSE_MULTI)
            ]
        ]

        if (& $event_style $FRAG_MKILL3) [
            uitext "MULTI-KILL" (*f $ui_texttiny 0.75) [
                uistyle leftmiddle
                uitextalign -1
                uicolourset (pulsecolour $PULSE_MULTI)
            ]
        ]

        if (& $event_style $FRAG_FIRSTBLOOD) [
            uitext "FIRST BLOOD" (*f $ui_texttiny 0.65) [
                uistyle leftmiddle
                uitextalign -1
                uicolourset (pulsecolour $PULSE_BLEED)
            ]
        ]

        if (& $event_style $FRAG_SPREE1) [
            uitext "CARNAGE" (*f $ui_texttiny 0.65) [
                uistyle leftmiddle
                uitextalign -1
                uicolourset (pulsecolour $PULSE_ACHIEVEMENT)
            ]
        ]

        if (& $event_style $FRAG_SPREE2) [
            uitext "SLAUGHTER" (*f $ui_texttiny 0.65) [
                uistyle leftmiddle
                uitextalign -1
                uicolourset (pulsecolour $PULSE_ACHIEVEMENT)
            ]
        ]

        if (& $event_style $FRAG_SPREE3) [
            uitext "MASSACRE" (*f $ui_texttiny 0.65) [
                uistyle leftmiddle
                uitextalign -1
                uicolourset (pulsecolour $PULSE_ACHIEVEMENT)
            ]
        ]

        if (& $event_style $FRAG_SPREE4) [
            uitext "BLOODBATH" (*f $ui_texttiny 0.65) [
                uistyle leftmiddle
                uitextalign -1
                uicolourset (pulsecolour $PULSE_BLOODBATH)
            ]
        ]
    ]

    if (& $event_actflags $HIT_PRIZE) [
        uitext "PRIZE WINNER" (*f $ui_texttiny 0.65) [
            uistyle leftmiddle
            uitextalign -1
            uicolourset (pulsecolour $PULSE_PRIZE)
        ]
    ]
]

// 1:<event id> 2:<event action>
on_frag_event = [
    local event_client event_target event_style
    event_client = (geteventtag $event_id "client" 0 "clientnum")
    event_target = (geteventtag $event_id "client" 1 "clientnum")
    event_style  = (geteventlist $event_id "args" "style")

    if (= $ui_hud_focus $event_target) [
        game_hud_frag $event_client

        if (& $event_style $FRAG_HEADSHOT) [
            game_hud_frag_special $GAME_HUD_FRAG_SPECIAL_HEADSHOT
        ]
        if (& $event_style $FRAG_REVENGE) [
            game_hud_frag_special $GAME_HUD_FRAG_SPECIAL_REVENGE
        ]
        if (& $event_style $FRAG_DOMINATE) [
            game_hud_frag_special $GAME_HUD_FRAG_SPECIAL_DOMINATING
        ]
        if (& $event_style $FRAG_BREAKER) [
            game_hud_frag_special $GAME_HUD_FRAG_SPECIAL_SPREEBREAKER
        ]
        if (& $event_style $FRAG_MKILL1) [
            game_hud_frag_special $GAME_HUD_FRAG_SPECIAL_DOUBLEKILL
        ]
        if (& $event_style $FRAG_MKILL2) [
            game_hud_frag_special $GAME_HUD_FRAG_SPECIAL_TRIPLEKILL
        ]
        if (& $event_style $FRAG_MKILL3) [
            game_hud_frag_special $GAME_HUD_FRAG_SPECIAL_MULTIKILL
        ]
        if (& $event_style $FRAG_FIRSTBLOOD) [
            game_hud_frag_special $GAME_HUD_FRAG_SPECIAL_FIRSTBLOOD
        ]
        if (& $event_style $FRAG_SPREE1) [
            game_hud_frag_special $GAME_HUD_FRAG_SPECIAL_CARNAGE
        ]
        if (& $event_style $FRAG_SPREE2) [
            game_hud_frag_special $GAME_HUD_FRAG_SPECIAL_SLAUGHTER
        ]
        if (& $event_style $FRAG_SPREE3) [
            game_hud_frag_special $GAME_HUD_FRAG_SPECIAL_MASSACRE
        ]
        if (& $event_style $FRAG_SPREE4) [
            game_hud_frag_special $GAME_HUD_FRAG_SPECIAL_BLOODBATH
        ]
    ] [
        if (= $ui_hud_focus $event_client) [
            game_hud_frag_by $event_target
        ]
    ]
]
