event_defend_secure = [
    uiimage (modetex) 0xFFFFFF 0 0 $ui_hud_texttiny [ uistyle leftmiddle; uiimageaspect 1; uiimageshadow 0.001 0x20202020 1 ]
    local event_extra event_affinity
    event_extra = 0
    event_affintiy = (geteventlist $event_id "args" "affinity")
    loop event_attackid $event_clients [
        if (= (geteventtag $event_id "client" $event_attackid "team") (geteventlist $event_id "args" (? (=s $event_action "secure") "owner" "enemy"))) [
            if $event_extra [
                uitext "+" $ui_texttiny [
                    uistyle leftmiddle
                    uitextalign -1
                ]
            ]
            uitext (geteventname $event_id "client" $event_attackid) $ui_texttiny [
                uistyle leftmiddle
                uitextalign -1
            ]
            event_extra = 1
        ]
    ]
    uiimage $pointtex (getteamcolour (geteventlist $event_id "args" "oldowner")) 0 0 $ui_hud_texttiny [ uistyle leftmiddle; uiimageaspect 1; uiimageshadow 0.001 0x20202020 1 ]
    uiimage $arrowrighttex 0xFFFFFF 0 0 $ui_hud_texttiny [ uistyle leftmiddle; uiimageaspect 1; uiimageshadow 0.001 0x20202020 1 ]
    uiimage $pointtex (getteamcolour (geteventlist $event_id "args" "owner")) 0 0 $ui_hud_texttiny [ uistyle leftmiddle; uiimageaspect 1; uiimageshadow 0.001 0x20202020 1 ]
    uitext (concatword (getdefendname $event_affinity) " (^fs^fy" (getprintable $event_affinity) "^fS)") $ui_texttiny [
        uistyle leftmiddle
        uitextalign -1
    ]
]

event_defend_overthrow = [@event_defend_secure]

// 1:<event id> 2:<event action>
on_defend_event = [
    local event_aff event_client
    event_aff    = (geteventlist $event_id "args" "affinity")
    event_client = (geteventtag $event_id "client" 0 "clientnum")

    cases $arg2 "secure" [
        if (= $ui_hud_focus $event_client) [
            game_hud_affinity_event $GAME_HUD_AFFINITY_SECURE $event_aff
        ]
    ]
]