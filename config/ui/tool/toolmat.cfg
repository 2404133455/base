ui_tool_mat_param_interval = (? (isonline) 250 0)

ui_tool_materials_list = [
    uitext "Material volumes in selection:" $ui_toolview_small_text_size
    uialign- -1 -2

    uicolour $ui_toolview_dark_colour 0 0 [
        uiclamp 1 1

        uispace $ui_toolview_small_elem_space $ui_toolview_small_elem_space [
            uiclamp 1 1

            uigrid 4 0 0 [
                uiclamp 1 1
                    if (= $tool_mat_numselmats 0) [
                        uicolourtext "<No materials>" $ui_toolview_dark_colour $ui_toolview_tiny_text_size
                    ]

                    loop i $tool_mat_numselmats [
                        mat = (at $tool_mat_selmats $i)
                        matname = (at $tool_mat_selmats_names $i)

                        uitarget 0 0 [
                            uicolourtext $matname $ui_toolview_dark_accent_colour $ui_toolview_tiny_text_size
                            uiclamp- 1 1

                            uihover [
                                ui_tool_button [
                                    uit_label = " X "
                                    uit_label_size = $ui_toolview_tiny_text_size
                                    uit_tip_simple = "Remove material"
                                    uit_pad = 0
                                    uit_on_click = [
                                        editmat air $mat
                                    ]
                                ]
                                uialign- 1
                            ]
                        ]
                        uiclamp- 1 1
                    ]

                    uiclamp* 1 1
            ]
        ]
    ]
]

ui_tool_materials_controls = [
    uihlist 0 [
        uiclamp 1 1
            ui_tool_button [
                uit_label = "Set material"
                uit_icon = @(tool_action_prop ta_setmat icon)
                uit_tip_action = ta_setmat
                uit_on_click = [
                    tool_do_action ta_setmat
                ]
                uit_width = 0.17
                uit_height = 0.03
            ]
    ]
]

tool_props_focus_water = 0
tool_props_focus_water_matname = water

tool_props_focus_lava = 0
tool_props_focus_lava_matname = lava

tool_props_focus_volfog = 0
tool_props_focus_volfog_matname = volfog

tool_props_focus_glass = 0
tool_props_focus_glass_matname = glass

// 1:<alt>
ui_tool_materials_surface_water = [
    result [
        uivlist 0 [
            ui_tool_numinput (concatword $tool_props_focus_water_matname fog @@arg2) 0 0 10 [
                uit_label = [@@@@(? $arg2 "" "Fog distance")]
                uit_label_size = $ui_toolview_tiny_text_size
                uit_interval = $ui_tool_mat_param_interval
                uit_val_format = i
            ]

            uifill 0 $ui_toolview_small_elem_space

            ui_tool_colour (concatword $tool_props_focus_water_matname colour @@arg2) [
                uit_label = @@@(? $arg2 "" "Colour")
                uit_label_size = $ui_toolview_tiny_text_size
                uit_interval = $ui_tool_mat_param_interval
                uit_val_format = i
                uit_flags = $TOOL_COLOUR_ZEROFIX
            ]

            uifill 0 $ui_toolview_small_elem_space

            ui_tool_numinput (concatword $tool_props_focus_water_matname refract @@arg2) 0 0 0.1 [
                uit_label = @@@(? $arg2 "" "Refract")
                uit_label_size = $ui_toolview_tiny_text_size
                uit_interval = $ui_tool_mat_param_interval
            ]

            ui_tool_colour (concatword $tool_props_focus_water_matname refractcolour @@arg2) [
                uit_label = [@@@@(? $arg2 "" "Refract colour")]
                uit_label_size = $ui_toolview_tiny_text_size
                uit_interval = $ui_tool_mat_param_interval
                uit_val_format = i
                uit_flags = $TOOL_COLOUR_ZEROFIX
            ]

            uifill 0 $ui_toolview_small_elem_space

            ui_tool_numinput (concatword $tool_props_focus_water_matname spec @@arg2) 0 0 10 [
                uit_label = @@@(? $arg2 "" "Specular")
                uit_label_size = $ui_toolview_tiny_text_size
                uit_interval = $ui_tool_mat_param_interval
                uit_val_format = i
            ]

            uifill 0 $ui_toolview_small_elem_space

            ui_tool_numinput (concatword $tool_props_focus_water_matname reflectstep @@arg2) 0 0 16 [
                uit_label = [@@@@(? $arg2 "" "Reflect ray step")]
                uit_label_size = $ui_toolview_tiny_text_size
                uit_interval = $ui_tool_mat_param_interval
                uit_val_format = i
            ]

            uiclamp 1 1
            uialign* 1
            uialign 1
        ]
    ]
]

// 1:<alt>
ui_tool_materials_deep_water = [
    result [
        uivlist 0 [
            ui_tool_numinput (concatword $tool_props_focus_water_matname deep @@arg2) 0 0 10 [
                uit_label = @@@(? $arg2 "" "Depth")
                uit_label_size = $ui_toolview_tiny_text_size
                uit_interval = $ui_tool_mat_param_interval
                uit_val_format = i
                uit_flags = $TOOL_COLOUR_ZEROFIX
            ]

            uifill 0 $ui_toolview_small_elem_space

            ui_tool_colour (concatword $tool_props_focus_water_matname deepcolour @@arg2) [
                uit_label = @@@(? $arg2 "" "Colour")
                uit_label_size = $ui_toolview_tiny_text_size
                uit_interval = $ui_tool_mat_param_interval
                uit_val_format = i
                uit_flags = $TOOL_COLOUR_ZEROFIX
            ]

            ui_tool_colour (concatword $tool_props_focus_water_matname deepfade @@arg2) [
                uit_label = [@@@@(? $arg2 "" "Edge colour")]
                uit_label_size = $ui_toolview_tiny_text_size
                uit_interval = $ui_tool_mat_param_interval
                uit_val_format = i
                uit_flags = $TOOL_COLOUR_ZEROFIX
            ]

            uiclamp 1 1
            uialign* 1
            uialign 1
        ]
    ]
]

ui_tool_materials_fall_water = [
    result [
        uivlist 0 [
            ui_tool_numinput (concatword $tool_props_focus_water_matname fallscrollx @@arg2) 0 0 1 [
                uit_label = [@@@@(? $arg2 "" "Scroll X")]
                uit_label_size = $ui_toolview_tiny_text_size
                uit_interval = $ui_tool_mat_param_interval
            ]

            ui_tool_numinput (concatword $tool_props_focus_water_matname fallscrolly @@arg2) 0 0 1 [
                uit_label = [@@@@(? $arg2 "" "Scroll Y")]
                uit_label_size = $ui_toolview_tiny_text_size
                uit_interval = $ui_tool_mat_param_interval
            ]

            uifill 0 $ui_toolview_small_elem_space

            ui_tool_colour (concatword $tool_props_focus_water_matname fallcolour @@arg2) [
                uit_label = @@@(? $arg2 "" "Colour")
                uit_label_size = $ui_toolview_tiny_text_size
                uit_interval = $ui_tool_mat_param_interval
                uit_val_format = i
                uit_flags = $TOOL_COLOUR_ZEROFIX
            ]

            uifill 0 $ui_toolview_small_elem_space

            ui_tool_numinput (concatword $tool_props_focus_water_matname fallrefract @@arg2) 0 0 0.1 [
                uit_label = @@@(? $arg2 "" "Refract")
                uit_label_size = $ui_toolview_tiny_text_size
                uit_interval = $ui_tool_mat_param_interval
            ]

            ui_tool_colour (concatword $tool_props_focus_water_matname fallrefractcolour @@arg2) [
                uit_label = [@@@@(? $arg2 "" "Refract colour")]
                uit_label_size = $ui_toolview_tiny_text_size
                uit_interval = $ui_tool_mat_param_interval
                uit_val_format = i
            ]

            uifill 0 $ui_toolview_small_elem_space

            ui_tool_numinput (concatword $tool_props_focus_water_matname fallspec @@arg2) 0 0 10 [
                uit_label = @@@(? $arg2 "" "Specular")
                uit_label_size = $ui_toolview_tiny_text_size
                uit_interval = $ui_tool_mat_param_interval
                uit_val_format = i
            ]

            uiclamp 1 1
            uialign* 1
            uialign 1
        ]
    ]
]

ui_tool_materials_behavior_water = [
    result [
        uivlist 0 [
            ui_tool_numinput (concatword $tool_props_focus_water_matname boost @@arg2) 0 0 0.1 [
                uit_label = @@@(? $arg2 "" "Boost")
                uit_label_size = $ui_toolview_tiny_text_size
                uit_interval = $ui_tool_mat_param_interval
            ]

            ui_tool_numinput (concatword $tool_props_focus_water_matname buoyancy @@arg2) 0 0 10 [
                uit_label = @@@(? $arg2 "" "Buoyancy")
                uit_label_size = $ui_toolview_tiny_text_size
                uit_interval = $ui_tool_mat_param_interval
            ]

            ui_tool_numinput (concatword $tool_props_focus_water_matname speed @@arg2) 0 0 0.1 [
                uit_label = @@@(? $arg2 "" "Speed")
                uit_label_size = $ui_toolview_tiny_text_size
                uit_interval = $ui_tool_mat_param_interval
            ]

            ui_tool_numinput (concatword $tool_props_focus_water_matname submerge @@arg2) 0 0 0.1 [
                uit_label = @@@(? $arg2 "" "Submerge")
                uit_label_size = $ui_toolview_tiny_text_size
                uit_interval = $ui_tool_mat_param_interval
            ]

            ui_tool_numinput (concatword $tool_props_focus_water_matname coast @@arg2) 0 0 10 [
                uit_label = @@@(? $arg2 "" "Coast")
                uit_label_size = $ui_toolview_tiny_text_size
                uit_interval = $ui_tool_mat_param_interval
            ]

            ui_tool_numinput (concatword $tool_props_focus_water_matname extinguish @@arg2) 0 0 0.1 [
                uit_label = @@@(? $arg2 "" "Extinguish")
                uit_label_size = $ui_toolview_tiny_text_size
                uit_interval = $ui_tool_mat_param_interval
            ]

            uifill 0 $ui_toolview_small_elem_space

            ui_tool_numinput (concatword $tool_props_focus_water_matname falldist @@arg2) 0 0 1 [
                uit_label = [@@@@(? $arg2 "" "Waterfall dist.")]
                uit_label_size = $ui_toolview_tiny_text_size
                uit_interval = $ui_tool_mat_param_interval
            ]

            ui_tool_numinput (concatword $tool_props_focus_water_matname fallpush @@arg2) 0 0 0.1 [
                uit_label = [@@@@(? $arg2 "" "Waterfall push")]
                uit_label_size = $ui_toolview_tiny_text_size
                uit_interval = $ui_tool_mat_param_interval
            ]

            ui_tool_numinput (concatword $tool_props_focus_water_matname fallspeed @@arg2) 0 0 10 [
                uit_label = [@@@@(? $arg2 "" "Waterfall speed")]
                uit_label_size = $ui_toolview_tiny_text_size
                uit_interval = $ui_tool_mat_param_interval
                uit_val_format = i
            ]

            uiclamp 1 1
            uialign* 1
            uialign 1
        ]
    ]
]

ui_tool_materials_obit_water = [
    result [
        uivlist 0 [
            ui_tool_textinput (concatword obit $tool_props_focus_water_matname) 24 [
                uit_label = "Message"
                uit_label_size = $ui_toolview_tiny_text_size
                uit_immediate = 0
            ]

            uiclamp 1 1
            uialign* 1
            uialign 1
        ]
    ]
]

// 1:<alt>
ui_tool_materials_surface_lava = [
    result [
        uivlist 0 [
            ui_tool_numinput (concatword $tool_props_focus_lava_matname fog @@arg2) 0 0 10 [
                uit_label = [@@@@(? $arg2 "" "Fog distance")]
                uit_label_size = $ui_toolview_tiny_text_size
                uit_interval = $ui_tool_mat_param_interval
                uit_val_format = i
            ]

            uifill 0 $ui_toolview_small_elem_space

            ui_tool_colour (concatword $tool_props_focus_lava_matname colour @@arg2) [
                uit_label = @@@(? $arg2 "" "Colour")
                uit_label_size = $ui_toolview_tiny_text_size
                uit_interval = $ui_tool_mat_param_interval
                uit_val_format = i
                uit_flags = $TOOL_COLOUR_ZEROFIX
            ]

            ui_tool_numinput (concatword $tool_props_focus_lava_matname glowmin @@arg2) 0 0 0.1 [
                uit_label = [@@@@(? $arg2 "" "Glow min.")]
                uit_label_size = $ui_toolview_tiny_text_size
                uit_interval = $ui_tool_mat_param_interval
            ]

            ui_tool_numinput (concatword $tool_props_focus_lava_matname glowmax @@arg2) 0 0 0.1 [
                uit_label = [@@@@(? $arg2 "" "Glow max.")]
                uit_label_size = $ui_toolview_tiny_text_size
                uit_interval = $ui_tool_mat_param_interval
            ]

            uifill 0 $ui_toolview_small_elem_space

            ui_tool_numinput (concatword $tool_props_focus_lava_matname scrollx @@arg2) 0 0 1 [
                uit_label = [@@@@(? $arg2 "" "Scroll X")]
                uit_label_size = $ui_toolview_tiny_text_size
                uit_interval = $ui_tool_mat_param_interval
            ]

            ui_tool_numinput (concatword $tool_props_focus_lava_matname scrolly @@arg2) 0 0 1 [
                uit_label = [@@@@(? $arg2 "" "Scroll Y")]
                uit_label_size = $ui_toolview_tiny_text_size
                uit_interval = $ui_tool_mat_param_interval
            ]

            uifill 0 $ui_toolview_small_elem_space

            ui_tool_numinput (concatword $tool_props_focus_lava_matname spec @@arg2) 0 0 10 [
                uit_label = @@@(? $arg2 "" "Specular")
                uit_label_size = $ui_toolview_tiny_text_size
                uit_interval = $ui_tool_mat_param_interval
                uit_val_format = i
            ]

            uiclamp 1 1
            uialign* 1
            uialign 1
        ]
    ]
]

ui_tool_materials_fall_lava = [
    result [
        uivlist 0 [
            ui_tool_numinput (concatword $tool_props_focus_lava_matname fallscrollx @@arg2) 0 0 1 [
                uit_label = [@@@@(? $arg2 "" "Scroll X")]
                uit_label_size = $ui_toolview_tiny_text_size
                uit_interval = $ui_tool_mat_param_interval
            ]

            ui_tool_numinput (concatword $tool_props_focus_lava_matname fallscrolly @@arg2) 0 0 1 [
                uit_label = [@@@@(? $arg2 "" "Scroll Y")]
                uit_label_size = $ui_toolview_tiny_text_size
                uit_interval = $ui_tool_mat_param_interval
            ]

            uiclamp 1 1
            uialign* 1
            uialign 1
        ]
    ]
]

ui_tool_materials_behavior_lava = [
    result [
        uivlist 0 [
            ui_tool_numinput (concatword $tool_props_focus_lava_matname boost @@arg2) 0 0 0.1 [
                uit_label = @@@(? $arg2 "" "Boost")
                uit_label_size = $ui_toolview_tiny_text_size
                uit_interval = $ui_tool_mat_param_interval
            ]

            ui_tool_numinput (concatword $tool_props_focus_lava_matname buoyancy @@arg2) 0 0 10 [
                uit_label = @@@(? $arg2 "" "Buoyancy")
                uit_label_size = $ui_toolview_tiny_text_size
                uit_interval = $ui_tool_mat_param_interval
            ]

            ui_tool_numinput (concatword $tool_props_focus_lava_matname speed @@arg2) 0 0 0.1 [
                uit_label = @@@(? $arg2 "" "Speed")
                uit_label_size = $ui_toolview_tiny_text_size
                uit_interval = $ui_tool_mat_param_interval
            ]

            ui_tool_numinput (concatword $tool_props_focus_lava_matname submerge @@arg2) 0 0 0.1 [
                uit_label = @@@(? $arg2 "" "Submerge")
                uit_label_size = $ui_toolview_tiny_text_size
                uit_interval = $ui_tool_mat_param_interval
            ]

            ui_tool_numinput (concatword $tool_props_focus_lava_matname coast @@arg2) 0 0 10 [
                uit_label = @@@(? $arg2 "" "Coast")
                uit_label_size = $ui_toolview_tiny_text_size
                uit_interval = $ui_tool_mat_param_interval
            ]

            uifill 0 $ui_toolview_small_elem_space

            ui_tool_numinput (concatword $tool_props_focus_lava_matname falldist @@arg2) 0 0 1 [
                uit_label = [@@@@(? $arg2 "" "Lavafall dist.")]
                uit_label_size = $ui_toolview_tiny_text_size
                uit_interval = $ui_tool_mat_param_interval
            ]

            ui_tool_numinput (concatword $tool_props_focus_lava_matname fallpush @@arg2) 0 0 0.1 [
                uit_label = [@@@@(? $arg2 "" "Lavafall push")]
                uit_label_size = $ui_toolview_tiny_text_size
                uit_interval = $ui_tool_mat_param_interval
            ]

            ui_tool_numinput (concatword $tool_props_focus_lava_matname fallspeed @@arg2) 0 0 10 [
                uit_label = [@@@@(? $arg2 "" "Lavafall speed")]
                uit_label_size = $ui_toolview_tiny_text_size
                uit_interval = $ui_tool_mat_param_interval
                uit_val_format = i
            ]

            uifill 0 $ui_toolview_small_elem_space

            ui_tool_numinput (concatword $tool_props_focus_lava_matname burndelay @@arg2) 0 0 500 [
                uit_label = [@@@@(? $arg2 "" "Burn delay (ms)")]
                uit_label_size = $ui_toolview_tiny_text_size
                uit_interval = $ui_tool_mat_param_interval
                uit_val_format = i
            ]

            ui_tool_numinput (concatword $tool_props_focus_lava_matname burntime @@arg2) 0 0 500 [
                uit_label = [@@@@(? $arg2 "" "Burn time (ms)")]
                uit_label_size = $ui_toolview_tiny_text_size
                uit_interval = $ui_tool_mat_param_interval
                uit_val_format = i
            ]

            uiclamp 1 1
            uialign* 1
            uialign 1
        ]
    ]
]

ui_tool_materials_obit_lava = [
    result [
        uivlist 0 [
            ui_tool_textinput (concatword obit $tool_props_focus_lava_matname) 24 [
                uit_label = "Message"
                uit_label_size = $ui_toolview_tiny_text_size
                uit_immediate = 0
            ]

            uiclamp 1 1
            uialign* 1
            uialign 1
        ]
    ]
]

ui_tool_materials_surface_volfog = [
    result [
        uivlist 0 [
            ui_tool_numinput (concatword $tool_props_focus_volfog_matname dist @@arg2) 0 0 10 [
                uit_label = [@@@@(? $arg2 "" "Fog distance")]
                uit_label_size = $ui_toolview_tiny_text_size
                uit_interval = $ui_tool_mat_param_interval
                uit_val_format = i
            ]

            uifill 0 $ui_toolview_small_elem_space

            ui_tool_colour (concatword $tool_props_focus_volfog_matname colour @@arg2) [
                uit_label = @@@(? $arg2 "" "Colour")
                uit_label_size = $ui_toolview_tiny_text_size
                uit_interval = $ui_tool_mat_param_interval
                uit_val_format = i
                uit_flags = $TOOL_COLOUR_ZEROFIX
            ]

            uifill 0 $ui_toolview_small_elem_space

            ui_tool_numinput (concatword $tool_props_focus_volfog_matname scrollx @@arg2) 0 0 1 [
                uit_label = [@@@@(? $arg2 "" "Scroll X")]
                uit_label_size = $ui_toolview_tiny_text_size
                uit_interval = $ui_tool_mat_param_interval
            ]

            ui_tool_numinput (concatword $tool_props_focus_volfog_matname scrolly @@arg2) 0 0 1 [
                uit_label = [@@@@(? $arg2 "" "Scroll Y")]
                uit_label_size = $ui_toolview_tiny_text_size
                uit_interval = $ui_tool_mat_param_interval
            ]

            uifill 0 $ui_toolview_small_elem_space

            ui_tool_numinput (concatword $tool_props_focus_volfog_matname texblend @@arg2) 0 0 0.1 [
                uit_label = [@@@@(? $arg2 "" "Texture blend")]
                uit_label_size = $ui_toolview_tiny_text_size
                uit_interval = $ui_tool_mat_param_interval
            ]

            ui_tool_colour (concatword $tool_props_focus_volfog_matname texcolour @@arg2) [
                uit_label = [@@@@(? $arg2 "" "Texture colour")]
                uit_label_size = $ui_toolview_tiny_text_size
                uit_interval = $ui_tool_mat_param_interval
                uit_val_format = i
            ]

            ui_tool_dropdown (concatword $tool_props_focus_volfog_matname texture @@arg2) [
                "None"
                "Evolution"
                "Simple"
            ] [
                uit_label = [@@@@(? $arg2 "" "Texture type")]
                uit_label_size = $ui_toolview_tiny_text_size
            ]

            uiclamp 1 1
            uialign* 1
            uialign 1
        ]
    ]
]

// 1:<alt>
ui_tool_materials_deep_volfog = [
    result [
        uivlist 0 [
            ui_tool_numinput (concatword $tool_props_focus_volfog_matname deep @@arg2) 0 0 10 [
                uit_label = @@@(? $arg2 "" "Depth")
                uit_label_size = $ui_toolview_tiny_text_size
                uit_interval = $ui_tool_mat_param_interval
                uit_val_format = i
            ]

            uifill 0 $ui_toolview_small_elem_space

            ui_tool_colour (concatword $tool_props_focus_volfog_matname deepcolour @@arg2) [
                uit_label = @@@(? $arg2 "" "Colour")
                uit_label_size = $ui_toolview_tiny_text_size
                uit_interval = $ui_tool_mat_param_interval
                uit_val_format = i
                uit_flags = $TOOL_COLOUR_ZEROFIX
            ]

            ui_tool_colour (concatword $tool_props_focus_volfog_matname deepfade @@arg2) [
                uit_label = [@@@@(? $arg2 "" "Edge colour")]
                uit_label_size = $ui_toolview_tiny_text_size
                uit_interval = $ui_tool_mat_param_interval
                uit_val_format = i
                uit_flags = $TOOL_COLOUR_ZEROFIX
            ]

            uiclamp 1 1
            uialign* 1
            uialign 1
        ]
    ]
]

ui_tool_materials_obit_volfog = [
    result [
        uivlist 0 [
            ui_tool_textinput (concatword obit $tool_props_focus_volfog_matname) 24 [
                uit_label = "Message"
                uit_label_size = $ui_toolview_tiny_text_size
                uit_immediate = 0
            ]

            uiclamp 1 1
            uialign* 1
            uialign 1
        ]
    ]
]

// 1:<alt>
ui_tool_materials_surface_glass = [
    result [
        uivlist 0 [
            ui_tool_colour (concatword $tool_props_focus_glass_matname colour @@arg2) [
                uit_label = @@@(? $arg2 "" "Colour")
                uit_label_size = $ui_toolview_tiny_text_size
                uit_interval = $ui_tool_mat_param_interval
                uit_val_format = i
                uit_flags = $TOOL_COLOUR_ZEROFIX
            ]

            uifill 0 $ui_toolview_small_elem_space

            ui_tool_numinput (concatword $tool_props_focus_glass_matname refract @@arg2) 0 0 0.1 [
                uit_label = @@@(? $arg2 "" "Refract")
                uit_label_size = $ui_toolview_tiny_text_size
                uit_interval = $ui_tool_mat_param_interval
            ]

            uifill 0 $ui_toolview_small_elem_space

            ui_tool_numinput (concatword $tool_props_focus_glass_matname spec @@arg2) 0 0 10 [
                uit_label = @@@(? $arg2 "" "Specular")
                uit_label_size = $ui_toolview_tiny_text_size
                uit_interval = $ui_tool_mat_param_interval
                uit_val_format = i
            ]

            uiclamp 1 1
            uialign* 1
            uialign 1
        ]
    ]
]

ui_tool_materials_obit_death = [
    result [
        uivlist 0 [
            ui_tool_textinput obitdeath 24 [
                uit_label = "Message"
                uit_label_size = $ui_toolview_tiny_text_size
                uit_immediate = 0
            ]

            uiclamp 1 1
            uialign* 1
            uialign 1
        ]
    ]
]

ui_tool_materials_behavior_hurt = [
    result [
        uivlist 0 [
            ui_tool_numinput hurtdamage 0 0 10 [
                uit_label = "Damage"
                uit_label_size = $ui_toolview_tiny_text_size
                uit_interval = $ui_tool_mat_param_interval
                uit_val_format = i
            ]

            ui_tool_numinput hurtdelay 0 0 500 [
                uit_label = "Damage delay (ms)"
                uit_label_size = $ui_toolview_tiny_text_size
                uit_interval = $ui_tool_mat_param_interval
                uit_val_format = i
            ]

            uifill 0 $ui_toolview_small_elem_space

            ui_tool_numinput hurtbleeddamage 0 0 10 [
                uit_label = "Bleed damage"
                uit_label_size = $ui_toolview_tiny_text_size
                uit_interval = $ui_tool_mat_param_interval
                uit_val_format = i
            ]

            ui_tool_numinput hurtbleeddelay 0 0 500 [
                uit_label = "Bleed delay (ms)"
                uit_label_size = $ui_toolview_tiny_text_size
                uit_interval = $ui_tool_mat_param_interval
                uit_val_format = i
            ]

            ui_tool_numinput hurtbleedtime 0 0 500 [
                uit_label = "Bleed time (ms)"
                uit_label_size = $ui_toolview_tiny_text_size
                uit_interval = $ui_tool_mat_param_interval
                uit_val_format = i
            ]

            uifill 0 $ui_toolview_small_elem_space

            ui_tool_numinput hurtburndamage 0 0 10 [
                uit_label = "Burn damage"
                uit_label_size = $ui_toolview_tiny_text_size
                uit_interval = $ui_tool_mat_param_interval
                uit_val_format = i
            ]

            ui_tool_numinput hurtburndelay 0 0 500 [
                uit_label = "Burn delay (ms)"
                uit_label_size = $ui_toolview_tiny_text_size
                uit_interval = $ui_tool_mat_param_interval
                uit_val_format = i
            ]

            ui_tool_numinput hurtburntime 0 0 500 [
                uit_label = "Burn time (ms)"
                uit_label_size = $ui_toolview_tiny_text_size
                uit_interval = $ui_tool_mat_param_interval
                uit_val_format = i
            ]

            uifill 0 $ui_toolview_small_elem_space

            ui_tool_numinput hurtshockdamage 0 0 10 [
                uit_label = "Shock damage"
                uit_label_size = $ui_toolview_tiny_text_size
                uit_interval = $ui_tool_mat_param_interval
                uit_val_format = i
            ]

            ui_tool_numinput hurtshockstun 0 0 1 [
                uit_label = "Shock stun"
                uit_label_size = $ui_toolview_tiny_text_size
                uit_interval = $ui_tool_mat_param_interval
                uit_val_format = i
            ]

            ui_tool_numinput hurtshockstunfall 0 0 0.01 [
                uit_label = "Shock stun fall"
                uit_label_size = $ui_toolview_tiny_text_size
                uit_interval = $ui_tool_mat_param_interval
            ]

            ui_tool_numinput hurtshockstunscale 0 0 0.1 [
                uit_label = "Shock stun scale"
                uit_label_size = $ui_toolview_tiny_text_size
                uit_interval = $ui_tool_mat_param_interval
            ]

            ui_tool_numinput hurtshockstuntime 0 0 500 [
                uit_label = "Shock stun time (ms)"
                uit_label_size = $ui_toolview_tiny_text_size
                uit_interval = $ui_tool_mat_param_interval
                uit_val_format = i
            ]

            ui_tool_numinput hurtshockdelay 0 0 500 [
                uit_label = "Shock delay (ms)"
                uit_label_size = $ui_toolview_tiny_text_size
                uit_interval = $ui_tool_mat_param_interval
                uit_val_format = i
            ]

            ui_tool_numinput hurtshocktime 0 0 500 [
                uit_label = "Shock time (ms)"
                uit_label_size = $ui_toolview_tiny_text_size
                uit_interval = $ui_tool_mat_param_interval
                uit_val_format = i
            ]

            uifill 0 $ui_toolview_small_elem_space

            uitext "Damage effects" $ui_toolview_tiny_text_size

            uigrid 3 0 0 [
                uiclamp 1 1

                ui_tool_compactswitch hurtresidual [
                    uit_label = "Burn"
                    uit_get = [
                        & $hurtresidual 1
                    ]
                    uit_set = [
                        ^ $arg1 1
                    ]
                ]

                ui_tool_compactswitch hurtresidual [
                    uit_label = "Bleed"
                    uit_get = [
                        & $hurtresidual 2
                    ]
                    uit_set = [
                        ^ $arg1 2
                    ]
                ]

                ui_tool_compactswitch hurtresidual [
                    uit_label = "Stun"
                    uit_get = [
                        & $hurtresidual 4
                    ]
                    uit_set = [
                        ^ $arg1 4
                    ]
                ]

                uiclamp* 1 1
            ]

            uiclamp 1 1
            uialign* 1
            uialign 1
        ]
    ]
]

ui_tool_materials_obit_hurt = [
    result [
        uivlist 0 [
            ui_tool_textinput obithurt 24 [
                uit_label = "Message"
                uit_label_size = $ui_toolview_tiny_text_size
                uit_immediate = 0
            ]

            uiclamp 1 1
            uialign* 1
            uialign 1
        ]
    ]
]

// 1:<contents> 2:<text> 3:<mat>
ui_tool_mat_param_group = [
    result [
        uitablerow [
            uiclamp 1 1
            uipad 0 $ui_toolview_large_elem_space 0 0 [
                uitext [@@@@arg2] $ui_toolview_small_text_size
            ]
            uialign- -1
            @@arg1
        ]
        uifill 0 $ui_toolview_small_elem_space
        uiline $ui_toolview_dark_accent_colour 0 0 [ uiclamp 1 1 ]
        uifill 0 $ui_toolview_small_elem_space
    ]
]

// 1:<contents> 2:<text> 3:<mat>
ui_tool_mat_param_group_noalt = [
    result [
        uitablerow [] [
            uiclamp 1 1
            uihlist $ui_toolview_large_elem_space [
                uitext [@@@@arg2] $ui_toolview_small_text_size
                uialign- -1
                @@@arg1
                uialign- 1
            ]
            uialign- -1
            uialign -1
        ]
        uifill 0 $ui_toolview_small_elem_space
        uiline $ui_toolview_dark_accent_colour 0 0 [ uiclamp 1 1 ]
        uifill 0 $ui_toolview_small_elem_space
    ]
]

// 1:<ui> 2:<text> 3:<mat>
ui_tool_mat_params = [
    ui_tool_mat_param_group [
        @($arg1)
        @($arg1 "" alt)
    ] $arg2 $arg3
]

// 1:<ui> 2:<text> 3:<mat>
ui_tool_mat_params_noalt = [
    ui_tool_mat_param_group_noalt [
        @($arg1)
    ] $arg2 $arg3
]

// 1:<content> 2:<mat>
ui_tool_mat_table = [
    local focusvar focusmatnamevar
    focusvar = [tool_props_focus_@arg2]
    focusmatnamevar = [tool_props_focus_@[arg2]_matname]

    result [
        uitablerow [] [
            uicolour $ui_toolview_dark_colour 0 0 [
                uihlist 0 [
                    loop i $tool_mat_num_variants [
                        local col selcol
                        col = $(concatword @@@@@arg2 (? $i (+ $i 1) "") "colour")
                        selcol = (? (= $i $@@@@@focusvar) $ui_toolview_accent_colour $ui_toolview_dark_colour)

                        ui_tool_button [
                            uit_width = 0.1
                            uit_height = 0.03
                            uit_on_click = [
                                @@@@@@@focusvar = @@i
                                @@@@@@@focusmatnamevar = @@(concatword @@@@@@@arg2 (? $i (+ $i 1) ""))
                            ]
                            uit_children = [
                                uioutline @@selcol
                                uiclamp- 1 1 1 1
                                uihlist $ui_toolview_small_elem_space [
                                    uicolour @@@col 0.01 0.01
                                    uicolourtext @@@(concatword "#" $i) @@@selcol $ui_toolview_tiny_text_size_factor
                                ]
                            ]
                        ]
                    ]
                    uialign* -1
                ]
                uialign- 1
            ]
        ]

        ui_tool_vscrollarea [
            uiclamp 1 1
            uitable $ui_toolview_base_elem_space $ui_toolview_small_elem_space [
                uiclamp 1 1
                uitableheader [
                    uifill
                    uicolourtext "Normal" (? (<= $forcemapvariant 1) $ui_toolview_accent_colour $ui_toolview_dark_accent_colour) $ui_toolview_small_text_size
                    uicolourtext "Alternative" (? (= $forcemapvariant 2) $ui_toolview_accent_colour $ui_toolview_dark_accent_colour) $ui_toolview_small_text_size
                ]

                uifill 0 $ui_toolview_small_elem_space
                uiline $ui_toolview_dark_accent_colour 0 0 [ uiclamp 1 1 ]

                @@@arg1
            ]
        ] [
            uit_height = 0.6
        ]
    ]
]

ui_tool_mat_tab_water = [
    @(ui_tool_mat_table [
        @(ui_tool_mat_params ui_tool_materials_surface_water "Surface" water)
        @(ui_tool_mat_params ui_tool_materials_deep_water "Deep phase" water)
        @(ui_tool_mat_params ui_tool_materials_fall_water "Waterfall" water)
        @(ui_tool_mat_params ui_tool_materials_behavior_water "Behavior" water)
        @(ui_tool_mat_params_noalt ui_tool_materials_obit_water "Obituary" water)
    ] water)
]

ui_tool_mat_tab_lava = [
    @(ui_tool_mat_table [
        @(ui_tool_mat_params ui_tool_materials_surface_lava "Surface" lava)
        @(ui_tool_mat_params ui_tool_materials_fall_lava "Lavafall" lava)
        @(ui_tool_mat_params ui_tool_materials_behavior_lava "Behavior" lava)
        @(ui_tool_mat_params_noalt ui_tool_materials_obit_lava "Obituary" lava)
    ] lava)
]

ui_tool_mat_tab_fog = [
    @(ui_tool_mat_table [
        @(ui_tool_mat_params ui_tool_materials_surface_volfog "Surface" volfog)
        @(ui_tool_mat_params ui_tool_materials_deep_volfog "Deep phase" volfog)
        @(ui_tool_mat_params_noalt ui_tool_materials_obit_volfog "Obituary" volfog)
    ] volfog)
]

ui_tool_mat_tab_glass = [
    @(ui_tool_mat_table [
        @(ui_tool_mat_params ui_tool_materials_surface_glass "Surface" glass)
    ] glass)
]

ui_tool_mat_tab_death = [
    @(ui_tool_mat_params_noalt ui_tool_materials_obit_death "Obituary" death)
]

ui_tool_mat_tab_hurt = [
    @(ui_tool_mat_params_noalt ui_tool_materials_behavior_hurt "Behavior" hurt)
    @(ui_tool_mat_params_noalt ui_tool_materials_obit_hurt "Obituary" hurt)
]

ui_tool_materials_properties = [
    uitext "Material properties" $ui_toolview_small_text_size
    uialign- -1 -2

    uifill 0 $ui_toolview_base_elem_space

    ui_tool_vtabs tool_mat_tabs [
        "textures/icons/edit/cube" // water
        "textures/icons/edit/cube" // lava
        "textures/icons/edit/fog" // fog
        "textures/icons/edit/cube" // glass
        "textures/icons/edit/cube" // death
        "textures/icons/edit/cube" // hurt
    ] [
        "Water"
        "Lava"
        "Fog volume"
        "Glass"
        "Death"
        "Hurt"
    ] [
        ui_tool_mat_tab_water
        ui_tool_mat_tab_lava
        ui_tool_mat_tab_fog
        ui_tool_mat_tab_glass
        ui_tool_mat_tab_death
        ui_tool_mat_tab_hurt
    ]
]

ui_tool_materials = [
    uivlist $ui_toolpanel_elem_space [
        uiclamp 1 1 1 1

        @@ui_tool_materials_list
        @@ui_tool_materials_controls

        uifill 0 $ui_toolview_small_elem_space
        uiline $ui_toolview_dark_accent_colour 0 0 [ uiclamp 1 1 ]
        uifill 0 $ui_toolview_small_elem_space

        @@ui_tool_materials_properties
    ]
]
